WARNING:inference(0):use checkpoint: runs/charades_cd/MDC_MP_128T_i3d_VALval_G1_L1_D1_5/model/MDC_MP_128T_i3d_VALval_G1_L1_D1_5_00019.ckp
INFO:inference(0):************************************************************************************************************************
warning: remove test(runs/charades_cd/inference) folder
INFO:inference(0):Video length, 128 Sentence Length 15
INFO:inference(0):test_ood, load captioning file, 1442 videos loaded
INFO:inference(0):Total 3375 sentences for test_ood
INFO:inference(0):testing:**********************************************************************************************************
Model**************************************************************************************************************
GMD(
  (sentence_encoder): RNNEncoder(
    (word_embed): Linear(in_features=300, out_features=300, bias=True)
    (rnn_cell): BiLSTM(
      (lstm): LSTM(300, 256, num_layers=2, batch_first=True, dropout=0.5, bidirectional=True)
    )
  )
  (video_encoder): QueryAwareEncoder(
    (blocks): ModuleList(
      (0): rnn_recalibration_layer(
        (rnn_cell): BiLSTM(
          (lstm): LSTM(1024, 256, num_layers=2, batch_first=True, dropout=0.5, bidirectional=True)
        )
        (attention): SCDM_Attention(
          (W_s): Linear(in_features=512, out_features=512, bias=False)
          (W_a): Linear(in_features=512, out_features=512, bias=True)
          (w): Linear(in_features=512, out_features=1, bias=False)
        )
        (sent_linear): Linear(in_features=512, out_features=512, bias=True)
      )
      (1): rnn_recalibration_layer(
        (rnn_cell): BiLSTM(
          (lstm): LSTM(512, 256, num_layers=2, batch_first=True, dropout=0.5, bidirectional=True)
        )
        (attention): SCDM_Attention(
          (W_s): Linear(in_features=512, out_features=512, bias=False)
          (W_a): Linear(in_features=512, out_features=512, bias=True)
          (w): Linear(in_features=512, out_features=1, bias=False)
        )
        (sent_linear): Linear(in_features=512, out_features=512, bias=True)
      )
    )
    (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
  )
  (CMI): VideoSentenceConcat()
  (span_predictor): SpanPredictor_Boundary(
    (predictor): MLP_predictor(
      (start_mlp_1): Linear(in_features=1024, out_features=256, bias=True)
      (start_mlp_2): Linear(in_features=256, out_features=1, bias=True)
      (end_mlp_1): Linear(in_features=1024, out_features=256, bias=True)
      (end_mlp_2): Linear(in_features=256, out_features=1, bias=True)
    )
  )
  (csmm): VideoTextSemanticMatch(
    (cross): VideoTextConcat()
    (temporal): NoTemporal()
    (predict): TwoLayerdMLP(
      (predict): Sequential(
        (0): Linear(in_features=1024, out_features=1024, bias=True)
        (1): ReLU()
        (2): Linear(in_features=1024, out_features=1, bias=True)
      )
    )
  )
  (tod): MomentPooling(
    (foreback_context): Sequential(
      (0): Linear(in_features=1024, out_features=512, bias=True)
      (1): ReLU(inplace=True)
    )
    (dropout): Dropout(p=0.5, inplace=False)
    (fc_classifier_domain_video): Sequential(
      (0): Linear(in_features=1536, out_features=2, bias=True)
    )
  )
)
load over. runs/charades_cd/MDC_MP_128T_i3d_VALval_G1_L1_D1_5/model/MDC_MP_128T_i3d_VALval_G1_L1_D1_5_00019.ckp
INFO:inference(0):test: epoch[000], batch[0000/0106], elapsed time=0.04s, loss: 8.328, miou: 0.411
INFO:inference(0):test: epoch[000], batch[0050/0106], elapsed time=0.03s, loss: 7.384, miou: 0.455
INFO:inference(0):test: epoch[000], batch[0100/0106], elapsed time=0.03s, loss: 7.417, miou: 0.409
INFO:inference(0):epoch [000]: elapsed time:4.9897s, avg loss: 6.800, miou: 0.443
INFO:inference(0):****************************************************************************************************
=> Proposal loaded over. runs/charades_cd/inference/submits/inference_00000_charades_test_ood.json
	mIoU	 0.1	0.3	0.5	0.7	0.9

 => 
1 	 44.28 	 75.35	63.85	46.84	27.47	6.64
mIoU	44.2800
Testing finished successfully!
